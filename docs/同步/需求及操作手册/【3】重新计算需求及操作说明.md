# IO清单生成规则 - 计算字段

**文档版本：** v1.1（2024最新）  
**生成日期：** 2025-10-22  
**更新日期：** 2025-11-06  
**适用系统：** 龙鳍（XT2）DCS控制系统  
**文档说明：** 本文档详细描述IO清单导出时各计算字段的Excel公式及其中文翻译说明

**最新更新：**
- 2025-11-06：更新板卡类型识别规则，PI211和FF211增加供电类型判断

---

## 📋 目录

1. [通道地址（Q列）](#1-通道地址q列)
2. [板卡类型（I列）](#2-板卡类型i列)
3. [板卡柜内编号（J列）](#3-板卡柜内编号j列)
4. [板卡编号（K列）](#4-板卡编号k列)
5. [板卡地址（S列）](#5-板卡地址s列)
6. [端子板型号（T列）](#6-端子板型号t列)
7. [端子板编号（U列）](#7-端子板编号u列)
8. [信号+（V列）](#8-信号v列)
9. [信号-（W列）](#9-信号-w列)
10. [补偿端+（X列）](#10-补偿端x列)
11. [补偿端-（Y列）](#11-补偿端-y列)
12. [FF从站模块编号（Z列）](#12-ff从站模块编号z列)
13. [FF从站模块信号+（AA列）](#13-ff从站模块信号aa列)
14. [FF从站模块信号-（AB列）](#14-ff从站模块信号-ab列)
15. [供电方式（AI列）](#15-供电方式ai列)
16. [显示格式（CB列）](#16-显示格式cb列)

---

## 1. 通道地址（Q列）

**Excel公式：**
```excel
=K3&"CH"&IF(N3<10,"0"&N3,N3)
```

**中文说明：** 生成完整的通道地址编号，拼接板卡编号（K列）+ "CH" + 通道号（N列，不足两位自动补零）。通道号小于10时，自动在前面补0。

**示例：**

| 板卡编号(K) | 通道号(N) | 结果 |
|:----------:|:--------:|:----:|
| C105AI     | 3        | C105AICH03 |
| D210RTD    | 15       | D210RTDCH15 |

---

## 2. 板卡类型（I列）

**Excel公式（2024最新版）：**
```excel
=IF(IFERROR(SEARCH("TCP",AG3),-1)>0,"MD216",
  IF(IFERROR(SEARCH("RTU",AG3),-1)>0,"MD211",
    IF(OR(IFERROR(SEARCH("DP",AG3),-1)>0,IFERROR(SEARCH("PROFIBUS",AG3),-1)>0),"DP211",
      IF(OR(LEFT(F3,2)="FF",IFERROR(SEARCH("FF",AG3),-1)>0),"FF211",
        IF(OR(LEFT(F3,1)="P",D3="PI",E3="P"),"PI211",
          IF(D3="AI",IF(IFERROR(SEARCH("NH",F3),-1)>0,"AI212",
            IF(IFERROR(SEARCH("4*20mA",AG3),-1)>0,"AI216",
              IF(IFERROR(SEARCH("TC",AG3),-1)>0,"AI221",
                IF(IFERROR(SEARCH("PT",AG3),-1)>0,"AI232","未知AI板卡")))),
            IF(D3="AO",IF(OR(F3="AO1",F3="AO2"),"AO211",IF(F3="AOH","AO215","未知AO板卡")),
              IF(D3="DI","DI211",
                IF(D3="DO","DO211",
                  IF(IFERROR(SEARCH("OPC",AG3),-1)>0,"--","未知板卡"))))))))))
```

**中文说明：** 根据描述、IO类型、供电类型等参数自动识别IO板卡型号。

**判断优先级（2024最新规则）：**
1. 描述包含"TCP" → **MD216**（MODBUS TCP通信卡）
2. 描述包含"RTU" → **MD211**（MODBUS RTU通信卡）
3. 描述包含"DP"或"PROFIBUS" → **DP211**（PROFIBUS DP总线卡）
4. **供电类型以"FF"开头** 或 描述包含"FF" → **FF211**（FF总线卡）⭐**新增规则**
5. **供电类型以"P"开头** 或 IO类型为"PI" 或 抗震类别为"P" → **PI211**（脉冲量输入卡）⭐**新增规则**
6. IO类型为"AI"：
   - 供电类型包含"NH" → **AI212**（计量泵等特殊模拟量输入）
   - 描述包含"4*20mA" → **AI216"（标准4-20mA模拟量输入）
   - 描述包含"TC" → **AI221**（热电偶输入卡）
   - 描述包含"PT" → **AI232**（热电阻输入卡）
7. IO类型为"AO"：
   - 供电类型为"AO1"或"AO2" → **AO211**（标准模拟量输出）
   - 供电类型为"AOH" → **AO215**（高精度模拟量输出）
8. IO类型为"DI" → **DI211**（数字量输入卡）
9. IO类型为"DO" → **DO211**（数字量输出卡）
10. 描述包含"OPC" → **--**（OPC协议，无需板卡）

**🆕 2024年更新说明：**
- **PI211识别增强**：除原有的IO类型和抗震类别判断外，新增供电类型以"P"开头即可识别为PI211
- **FF211识别增强**：除原有的描述包含"FF"判断外，新增供电类型以"FF"开头即可识别为FF211
- **优先级调整**：将FF211和PI211的判断提前到AI/AO类型之前（第4、5层），避免误判

**板卡类型对照表：**

| 板卡型号 | 板卡名称 | 适用信号类型 |
|:-------:|:-------:|:----------:|
| AI216 | 标准模拟量输入 | 4-20mA电流信号 |
| AI212 | 特殊模拟量输入 | 特殊电流信号（计量泵等） |
| AI221 | 热电偶输入 | TC温度信号 |
| AI232 | 热电阻输入 | PT100/PT1000温度信号 |
| AO211 | 标准模拟量输出 | 4-20mA电流输出 |
| AO215 | 高精度模拟量输出 | 高精度4-20mA输出 |
| DI211 | 数字量输入 | 开关量输入 |
| DO211 | 数字量输出 | 开关量输出 |
| PI211 | 脉冲量输入 | 频率/脉冲信号 |
| FF211 | FF总线卡 | Foundation Fieldbus |
| DP211 | DP总线卡 | PROFIBUS DP |
| MD211 | MODBUS RTU卡 | MODBUS RTU协议 |
| MD216 | MODBUS TCP卡 | MODBUS TCP协议 |

---

## 3. 板卡柜内编号（J列）

**Excel公式：**
```excel
=IF(I3="--","--",L3&TEXT(M3,"00")&IF(I3="AI232","RTD",IF(I3="AI221","TC",LEFT(I3,2))))
```

**中文说明：** 生成机柜内唯一的板卡编号。当板卡类型为“--”时返回“--”，否则拼接笼号（L列） + 槽位（M列，格式化为两位数） + 类型标识。

**类型标识规则：**

| 板卡类型 | 类型标识 | 说明 |
|:-------:|:-------:|:----:|
| AI232 | RTD | 热电阻（Resistance Temperature Detector） |
| AI221 | TC | 热电偶（ThermoCouple） |
| 其他 | 前两位字符 | 如AI216→AI，DI211→DI |

**示例：**

| 笼号(L) | 槽位(M) | 板卡类型(I) | 结果 |
|:-------:|:-------:|:----------:|:----:|
| 1 | 5 | AI216 | 105AI |
| 2 | 10 | AI232 | 210RTD |
| 1 | 3 | AI221 | 103TC |
| 2 | 8 | DI211 | 208DI |

---

## 4. 板卡编号（K列）

**Excel公式：**
```excel
=IF(I3="--","--",H3&J3)
```

**中文说明：** 生成系统级唯一的完整板卡编号。当板卡类型为“--”时返回“--”，否则拼接机柜号（H列） + 板卡柜内编号（J列）。

**示例：**

| 机柜号(H) | 板卡柜内编号(J) | 板卡类型(I) | 结果 |
|:--------:|:-------------:|:----------:|:----:|
| C | 105AI | AI216 | C105AI |
| D | 210RTD | AI232 | D210RTD |
| -- | -- | -- | -- |

---

## 5. 板卡地址（S列）

**Excel公式：**
```excel
=IF(I3="--","--",(L3-1)*10+M3)
```

**中文说明：** 计算板卡在系统中的唯一地址编号，计算公式为 `(笼号 - 1) × 10 + 槽位号`。每个笼架支持最多10个槽位（1-10），地址空间为1-125。

**地址分配示例：**

| 笼号(L) | 槽位(M) | 板卡类型(I) | 计算过程 | 结果 |
|:-------:|:-------:|:----------:|:--------:|:----:|
| 1 | 1 | AI216 | (1-1)×10+1 | 1 |
| 1 | 10 | DI211 | (1-1)×10+10 | 10 |
| 2 | 1 | AI232 | (2-1)×10+1 | 11 |
| 3 | 5 | DO211 | (3-1)×10+5 | 25 |
| -- | -- | -- | -- | -- |

**说明：** 每个笼架支持最多10个槽位（1-10），地址空间为1-125

---

## 6. 端子板型号（T列）

**Excel公式：**
```excel
=IF(I3="DI211",IF(LEFT(AI3,4)="USER","TB221","TB222"),
  IF(I3="DO211",IF(LEFT(AI3,4)="USER","TB231","TB233"),
    IF(OR(I3="AI216",I3="AI212"),"TB241",
      IF(I3="AI221","TB242",
        IF(I3="AI232","TB246",
          IF(I3="AO211","TB251",
            IF(OR(I3="PI211",I3="AO215",I3="MD211"),"TB244",
              IF(I3="MD216","--",
                IF(I3="FF211","TB271",
                  IF(I3="DP211","TB272",
                    IF(I3="--","--","ERR")))))))))))
```

**中文说明：** 根据板卡类型和供电方式自动选择端子板型号。

**选型规则表：**

| 板卡类型 | 供电方式判断 | 端子板型号 | 端子板说明 |
|:-------:|:----------:|:--------:|:---------:|
| DI211 | USER开头 | TB221 | 数字量输入（用户供电） |
| DI211 | DCS供电 | TB222 | 数字量输入（DCS供电） |
| DO211 | USER开头 | TB231 | 数字量输出（用户供电） |
| DO211 | DCS供电 | TB233 | 数字量输出（DCS供电） |
| AI216/AI212 | -- | TB241 | 4-20mA信号调理 |
| AI221 | -- | TB242 | 热电偶信号调理 |
| AI232 | -- | TB246 | 热电阻信号调理 |
| AO211 | -- | TB251 | 模拟量输出 |
| PI211/AO215/MD211 | -- | TB244 | 多功能端子板 |
| MD216 | -- | -- | MODBUS TCP无需端子板 |
| FF211 | -- | TB271 | FF总线端子板 |
| DP211 | -- | TB272 | DP总线端子板 |
| -- | -- | -- | 无板卡 |
| 其他 | -- | ERR | 选型错误 |

---

## 7. 端子板编号（U列）

**Excel公式：**
```excel
=IF(I3="FF211",L3&TEXT(M3,"00")&"_"&N3&"FI",
  IF(OR(I3="MD216",I3="--"),"--",
    L3&TEXT(M3,"00")&"BN"))
```

**中文说明：** 生成端子板的唯一编号。

**编号规则：**

| 板卡类型 | 编号格式 | 示例 | 说明 |
|:-------:|:-------:|:----:|:----:|
| FF211 | {笼号}{槽位:00}_{通道号}FI | 101_1FI | FF总线，使用通道号标识网段 |
| MD216 | -- | -- | MODBUS TCP无需端子板 |
| -- | -- | -- | 无板卡 |
| 其他板卡 | {笼号}{槽位:00}BN | 205BN | 普通端子板编号 |

**示例：**

| 笼号(L) | 槽位(M) | 通道(N) | 板卡类型(I) | 结果 |
|:-------:|:-------:|:-------:|:----------:|:----:|
| 1 | 1 | 1 | FF211 | 101_1FI |
| 1 | 1 | 2 | FF211 | 101_2FI |
| 2 | 5 | 3 | AI216 | 205BN |
| -- | -- | -- | MD216 | -- |

---

## 8. 信号+（V列）

**Excel公式：**
```excel
=IF(OR(T3="TB221",T3="TB222",T3="TB242",T3="TB243",T3="TB246"),N3&"A",
  IF(AND(OR(T3="TB231",T3="TB232",T3="TB233"),OR(AN3="",AN3="NO")),N3&"B",
    IF(AND(OR(T3="TB231",T3="TB232",T3="TB233"),AN3="NC"),N3&"A",
      IF(AND(T3="TB241",OR(I3="AI212",I3="AI216")),N3&CHOOSE(MID(AI3,3,1),"B","A","A","A","A","B"),
        IF(AND(T3="TB244",I3="AO215"),N3*2+22,
          IF(AND(T3="TB244",I3="PI211"),(N3-1)*4+2,
            IF(AND(T3="TB244",I3="MD211"),CHOOSE(N3,"8","28"),
              IF(T3="TB271","a",
                IF(OR(T3="TB272",T3="TB271"),"--",
                  IF(T3="TB251",N3&"B",
                    IF(T3="--","--","Err")))))))))))
```

**中文说明：** 计算信号在端子板上的正极连接点位置。

**连接点规则表：**

| 端子板型号 | 板卡类型 | 其他条件 | 连接点格式 | 示例 |
|:---------:|:-------:|:-------:|:---------:|:----:|
| TB221/TB222/TB242/TB243/TB246 | -- | -- | {通道}A | 3A |
| TB231/TB232/TB233 | -- | 信号有效=""或"NO" | {通道}B | 5B |
| TB231/TB232/TB233 | -- | 信号有效="NC" | {通道}A | 5A |
| TB241 | AI212/AI216 | 根据供电方式第3位 | {通道}+字母 | 2A或2B |
| TB244 | AO215 | -- | {通道}×2+22 | 24（通道1） |
| TB244 | PI211 | -- | ({通道}-1)×4+2 | 2（通道1） |
| TB244 | MD211 | 通道1 | 8 | 8 |
| TB244 | MD211 | 通道2 | 28 | 28 |
| TB271 | -- | -- | a | a（FF总线） |
| TB272 | -- | -- | -- | -- |
| TB251 | -- | -- | {通道}B | 3B |
| -- | -- | -- | -- | -- |
| 其他 | -- | -- | Err | Err |

**供电方式第3位对应规则（TB241+AI212/AI216）：**
| 供电方式第3位 | 连接点后缀 |
|:-----------:|:--------:|
| 1 | B |
| 2,3,4,5 | A |
| 6 | B |

---

## 9. 信号-（W列）

**Excel公式：**
```excel
=IF(OR(T3="TB221",T3="TB222",T3="TB242",T3="TB246"),N3&"B",
  IF(OR(T3="TB231",T3="TB233",T3="TB251"),N3&"C",
    IF(AND(T3="TB241",OR(I3="AI212",I3="AI216")),N3&CHOOSE(MID(AI3,3,1),"A","C","C","C","C","A"),
      IF(AND(T3="TB244",I3="AO215"),N3*2+19,
        IF(AND(T3="TB244",I3="PI211"),N3*4,
          IF(AND(T3="TB244",I3="MD211"),CHOOSE(N3,"12","32"),
            IF(T3="TB271","b",
              IF(OR(T3="TB272",T3="TB271"),"--",
                IF(T3="--","--","Err")))))))))
```

**中文说明：** 计算信号在端子板上的负极连接点位置。

**连接点规则表：**

| 端子板型号 | 板卡类型 | 其他条件 | 连接点格式 | 示例 |
|:---------:|:-------:|:-------:|:---------:|:----:|
| TB221/TB222/TB242/TB246 | -- | -- | {通道}B | 3B |
| TB231/TB233/TB251 | -- | -- | {通道}C | 5C |
| TB241 | AI212/AI216 | 根据供电方式第3位 | {通道}+字母 | 2A或2C |
| TB244 | AO215 | -- | {通道}×2+19 | 21（通道1） |
| TB244 | PI211 | -- | {通道}×4 | 4（通道1） |
| TB244 | MD211 | 通道1 | 12 | 12 |
| TB244 | MD211 | 通道2 | 32 | 32 |
| TB271 | -- | -- | b | b（FF总线） |
| TB272 | -- | -- | -- | -- |
| -- | -- | -- | -- | -- |
| 其他 | -- | -- | Err | Err |

**供电方式第3位对应规则（TB241+AI212/AI216）：**
| 供电方式第3位 | 连接点后缀 |
|:-----------:|:--------:|
| 1 | A |
| 2,3,4,5 | C |
| 6 | A |

---

## 10. 补偿端+（X列）

**Excel公式：**
```excel
=IF(T3="TB271","IE-BUS",
  IF(OR(AI3="AI7",AI3="AI8",AI3="AI9"),N3&"C",
    IF(AND(T3="TB244",I3="MD211"),"GND:"&CHOOSE(N3,"10","30"),
      "--")))
```

**中文说明：** 计算RTD温度传感器的C端补偿连接点。

**连接规则表：**

| 端子板型号 | 板卡类型 | 供电方式 | 连接点 | 说明 |
|:---------:|:-------:|:-------:|:-----:|:----:|
| TB271 | -- | -- | IE-BUS | FF总线系统补偿 |
| -- | -- | AI7 | {通道}C | 温度补偿C端 |
| -- | -- | AI8 | {通道}C | 温度补偿C端 |
| -- | -- | AI9 | {通道}C | 温度补偿C端 |
| TB244 | MD211 | -- 通道1 | GND:10 | 接地端（通道1） |
| TB244 | MD211 | -- 通道2 | GND:30 | 接地端（通道2） |
| 其他 | -- | -- | -- | 不需要补偿 |

**示例：**

| 端子板型号(T) | 板卡类型(I) | 供电方式(AI) | 通道(N) | 结果 |
|:-----------:|:---------:|:----------:|:-------:|:----:|
| TB271 | FF211 | -- | 1 | IE-BUS |
| TB246 | AI232 | AI9 | 3 | 3C |
| TB244 | MD211 | -- | 1 | GND:10 |
| TB241 | AI216 | AI1 | 2 | -- |

---

## 11. 补偿端-（Y列）

**Excel公式：**
```excel
=IF(AI3="AI9",N3&"D","--")
```

**中文说明：** 计算RTD温度传感器的D端补偿连接点（仅四线制PT100需要）。

**连接规则：**

| 供电方式(AI) | 连接点格式 | 示例 | 说明 |
|:----------:|:---------:|:----:|:----:|
| AI9 | {通道}D | 3D | 四线制PT100的D端连接 |
| 其他 | -- | -- | 不需要D端连接 |

**示例：**

| 供电方式(AI) | 通道(N) | 结果 |
|:----------:|:-------:|:----:|
| AI9 | 3 | 3D |
| AI7 | 5 | -- |
| AI1 | 2 | -- |

---

## 12. FF从站模块编号（Z列）

**Excel公式：**
```excel
=IF(IFERROR(SEARCH("FS",Z3),-1)>0,G3&"_"&O3&"_"&Z3,"--")
```

**中文说明：** 生成FF从站模块的完整编号。检查FF从站模块型号（Z列）是否包含"FS"，包含则拼接{就地箱号(G)}_{FF/DP从站号(O)}_{模块型号(Z)}，否则返回"--"。

**示例：**

| 就地箱号(G) | FF/DP从站号(O) | FF从站模块型号(Z) | 结果 |
|:---------:|:------------:|:--------------:|:----:|
| JD001 | 01 | FS100 | JD001_01_FS100 |
| JD002 | 02 | FS200 | JD002_02_FS200 |
| -- | -- | -- | -- |

---

## 13. FF从站模块信号+（AA列）

**Excel公式：**
```excel
=IF(IFERROR(SEARCH("FS",Z3),-1)>0,
  IF(AND(IFERROR(SEARCH("A",AF3),-1)>0,IFERROR(SEARCH("四",AH3),-1)>0),P3&"A",
    IF(IFERROR(SEARCH("AI",AF3),-1)>0,P3&"B",
      IF(IFERROR(SEARCH("AO",AF3),-1)>0,P3&"C",
        IF(IFERROR(SEARCH("DI",AF3),-1)>0,P3&"A",
          IF(AND(IFERROR(SEARCH("DO",AF3),-1)>0,IFERROR(SEARCH("NC",AN3),-1)>0),P3&"A",
            IF(IFERROR(SEARCH("DO",AF3),-1)>0,P3&"B","--")))))),
  "--")
```

**中文说明：** 计算FF从站模块的信号正极连接点（前提条件：FF从站模块型号包含“FS”）。

**连接点规则表：**

| IO类型(AF) | 传感器类型(AH) | 信号有效(AN) | FF通道(P) | 连接点格式 | 示例 |
|:---------:|:------------:|:----------:|:--------:|:---------:|:----:|
| 包含"A" | 包含"四" | -- | 1 | {FF通道}A | 1A |
| 包含"AI" | -- | -- | 2 | {FF通道}B | 2B |
| 包含"AO" | -- | -- | 3 | {FF通道}C | 3C |
| 包含"DI" | -- | -- | 4 | {FF通道}A | 4A |
| 包含"DO" | -- | 包含"NC" | 5 | {FF通道}A | 5A |
| 包含"DO" | -- | 其他 | 6 | {FF通道}B | 6B |
| 其他 | -- | -- | -- | -- | -- |

---

## 14. FF从站模块信号-（AB列）

**Excel公式：**
```excel
=IF(IFERROR(SEARCH("FS",Z3),-1)>0,
  IF(AND(IFERROR(SEARCH("A",AF3),-1)>0,IFERROR(SEARCH("四",AH3),-1)>0),P3&"C",
    IF(IFERROR(SEARCH("AI",AF3),-1)>0,P3&"A",
      IF(IFERROR(SEARCH("AO",AF3),-1)>0,P3&"B",
        IF(IFERROR(SEARCH("DI",AF3),-1)>0,P3&"B",
          IF(AND(IFERROR(SEARCH("DO",AF3),-1)>0,IFERROR(SEARCH("无源",AH3),-1)>0),P3&"C",
            IF(IFERROR(SEARCH("DO",AF3),-1)>0,P3&"D","--")))))),
  "--")
```

**中文说明：** 计算FF从站模块的信号负极连接点（前提条件：FF从站模块型号包含“FS”）。

**连接点规则表：**

| IO类型(AF) | 传感器类型(AH) | FF通道(P) | 连接点格式 | 示例 |
|:---------:|:------------:|:--------:|:---------:|:----:|
| 包含"A" | 包含"四" | 1 | {FF通道}C | 1C |
| 包含"AI" | -- | 2 | {FF通道}A | 2A |
| 包含"AO" | -- | 3 | {FF通道}B | 3B |
| 包含"DI" | -- | 4 | {FF通道}B | 4B |
| 包含"DO" | 包含"无源" | 5 | {FF通道}C | 5C |
| 包含"DO" | 其他 | 6 | {FF通道}D | 6D |
| 其他 | -- | -- | -- | -- |

---

## 15. 供电方式（AI列）

**Excel公式：**
```excel
=IF(OR(IFERROR(SEARCH("TCP",AG3),-1)>0,IFERROR(SEARCH("RTU",AG3),-1)>0),"--",
  IF(LEFT(AI4,2)="AI",CHOOSE(MID(AI4,3,IF(IFERROR(SEARCH("NH",AI4),-1)>0,"1",LEN(AI4)-1)),"DCS","DCS(提供24VDC)","DCS(提供220VAC)","USER","USER","DCS(提供220VAC)","DCS","DCS","DCS","DCS"),
    IF(LEFT(AI4,2)="AO","DCS",
      IF(LEFT(AI4,1)="P",CHOOSE(MID(AI4,2,LEN(AI4)-1),"DCS(提供24VDC)","DCS(提供220VAC)","USER"),
        IF(LEFT(AI4,2)="DI",CHOOSE(MID(AI4,3,LEN(AI4)-1),"DCS","DCS(提供24VDC)","DCS(提供220VAC)","USER","USER","DCS(提供24VDC)"),
          IF(LEFT(AI4,2)="DO",CHOOSE(MID(AI4,3,LEN(AI4)-1),"DCS","DCS(提供24VDC)","DCS(提供220VAC)","USER","USER"),
            IF(LEFT(AI4,2)="FF",CHOOSE(MID(AI4,3,LEN(AI4)-1),"DCS","DCS(提供24VDC)","DCS(提供220VAC)","USER","USER","DCS","DCS","DCS"),
              IF(LEFT(AI4,2)="DP","DCS(提供220VAC)",
                IF(IFERROR(SEARCH("DP",AG4),-1)>0,"--",
                  IF(IFERROR(SEARCH("OPC",AG4),-1)>0,"--","Err"))))))))))
```

**中文说明：** 根据描述和供电类型判断供电方式。

**判断优先级表：**

| 条件 | 供电类型(F) | 编号 | 供电方式 |
|:---:|:---------:|:---:|:-------:|
| 描述包含TCP/RTU | -- | -- | -- |
| 供电类型前2位=AI | AI1 | 1 | DCS |
| 供电类型前2位=AI | AI2 | 2 | DCS(提供24VDC) |
| 供电类型前2位=AI | AI3 | 3 | DCS(提供220VAC) |
| 供电类型前2位=AI | AI4 | 4 | USER |
| 供电类型前2位=AI | AI5 | 5 | USER |
| 供电类型前2位=AI | AI6 | 6 | DCS(提供220VAC) |
| 供电类型前2位=AI | AI7/8/9 | 7/8/9 | DCS |
| 供电类型前2位=AI | 包含NH | -- | 取第1位判断 |
| 供电类型前2位=AO | -- | -- | DCS |
| 供电类型第1位=P | P1 | 1 | DCS(提供24VDC) |
| 供电类型第1位=P | P2 | 2 | DCS(提供220VAC) |
| 供电类型第1位=P | P3 | 3 | USER |
| 供电类型前2位=DI | DI1 | 1 | DCS |
| 供电类型前2位=DI | DI2 | 2 | DCS(提供24VDC) |
| 供电类型前2位=DI | DI3 | 3 | DCS(提供220VAC) |
| 供电类型前2位=DI | DI4/5 | 4/5 | USER |
| 供电类型前2位=DI | DI6 | 6 | DCS(提供24VDC) |
| 供电类型前2位=DO | DO1 | 1 | DCS |
| 供电类型前2位=DO | DO2 | 2 | DCS(提供24VDC) |
| 供电类型前2位=DO | DO3 | 3 | DCS(提供220VAC) |
| 供电类型前2位=DO | DO4/5 | 4/5 | USER |
| 供电类型前2位=FF | FF1 | 1 | DCS |
| 供电类型前2位=FF | FF2 | 2 | DCS(提供24VDC) |
| 供电类型前2位=FF | FF3 | 3 | DCS(提供220VAC) |
| 供电类型前2位=FF | FF4/5 | 4/5 | USER |
| 供电类型前2位=FF | FF6/7/8 | 6/7/8 | DCS |
| 供电类型前2位=DP | -- | -- | DCS(提供220VAC) |
| 描述包含DP | -- | -- | -- |
| 描述包含OPC | -- | -- | -- |
| 其他 | -- | -- | Err |

---

## 16. 显示格式（CB列）

**Excel公式：**
```excel
=IF(AM3="","",
  IF(AK3="r/min",0,
    IF(ABS(AM3-AL3)<=10,3,
      IF(AND((10<ABS(AM3-AL3)),(ABS(AM3-AL3)<=100)),2,
        IF(100<ABS(AM3-AL3),1,"")))))
```

**中文说明：** 根据测量范围和工程单位自动计算小数位数。

**计算逻辑表：**

| 上限(AM) | 下限(AL) | 工程单位(AK) | 范围 | 小数位数 | 说明 |
|:-------:|:-------:|:----------:|:----:|:-------:|:----:|
| 空 | -- | -- | -- | 空 | 上限为空不显示 |
| 100 | 0 | r/min | 100 | 0 | 转速不显示小数 |
| 10 | 0 | ℃ | 10 | 3 | 范围≤10，高精度 |
| 5.5 | -4.5 | bar | 10 | 3 | 范围≤10，高精度 |
| 50 | 0 | ℃ | 50 | 2 | 10<范围≤100，中精度 |
| 100 | 0 | kPa | 100 | 2 | 10<范围≤100，中精度 |
| 200 | 0 | ℃ | 200 | 1 | 范围>100，低精度 |
| 1000 | 0 | kPa | 1000 | 1 | 范围>100，低精度 |

**精度分级规则：**

| 测量范围 | 小数位数 | 适用场景 |
|:-------:|:-------:|:-------:|
| ≤ 10 | 3位 | 高精度测量（温度、压力等小量程） |
| 10 ~ 100 | 2位 | 中精度测量（常规工艺参数） |
| > 100 | 1位 | 低精度测量（大量程参数） |
| 工程单位="r/min" | 0位 | 转速不需要小数 |

---

## 📝 附录：字段列对照表

| 列号 | 字段名称 | 英文字段 | 说明 |
|:---:|:-------:|:-------:|:----:|
| D | IO类型 | IoType | AI/AO/DI/DO/PI/FF等 |
| E | 抗震类别 | SeismicCategory | P表示脉冲量 |
| F | 供电类型 | PowerType | AI1~9/AO1~2/DI1~6等 |
| G | 就地箱号 | LocalBoxNumber | 现场就地控制箱编号 |
| H | 机柜编号 | CabinetNumber | 机柜位置标识 |
| I | 板卡类型 | CardType | AI216/DI211等（计算字段） |
| J | 板卡柜内编号 | CardNumberInCabinet | 柜内唯一编号（计算字段） |
| K | 板卡编号 | CardNumber | 系统级编号（计算字段） |
| L | 笼号 | Cage | 机柜内笼架编号 |
| M | 槽位 | Slot | 笼架内槽位号 |
| N | 通道号 | Channel | 板卡通道号 |
| O | FF/DP从站号 | FFDPStaionNumber | 现场总线从站地址 |
| P | FF端子通道 | FFTerminalChannel | FF从站模块通道 |
| Q | 通道地址 | ChannelAddress | 完整通道地址（计算字段） |
| S | 板卡地址 | CardAddress | 系统地址（计算字段） |
| T | 端子板型号 | TerminalBoardModel | TB221~TB272（计算字段） |
| U | 端子板编号 | TerminalBoardNumber | 端子板唯一编号（计算字段） |
| V | 信号+ | SignalPlus | 正极连接点（计算字段） |
| W | 信号- | SignalMinus | 负极连接点（计算字段） |
| X | 补偿端+ | RTDCompensationC | C端补偿（计算字段） |
| Y | 补偿端- | RTDCompensationE | D端补偿（计算字段） |
| Z | FF从站模块型号 | FFSlaveModuleModel | 如FS100/FS200 |
| AG | 描述 | Description | 信号描述说明 |
| AH | 传感器类型 | SensorType | 四线制/三线制/PT100等 |
| AI | 供电方式 | PowerSupplyMethod | DCS/USER等（计算字段） |
| AK | 工程单位 | EngineeringUnit | ℃/kPa/r/min等 |
| AL | 测量范围下限 | RangeLowerLimit | 量程下限值 |
| AM | 测量范围上限 | RangeUpperLimit | 量程上限值 |
| AN | 信号有效方式 | SignalEffectiveMode | NO/NC（常开/常闭） |
| AF | IO类型 | IoType | 用于FF模块判断 |
| CB | 显示格式 | OFDisplayFormat | 小数位数（计算字段） |

---

## 🔍 使用说明

1. **计算字段标识**：标题中带"（计算字段）"的列为自动计算生成，不需要手工填写
2. **公式依赖关系**：部分字段的计算依赖其他字段，请确保前序字段已正确填写
3. **数据验证**：计算结果出现"Err"或"ERR"表示数据异常，需检查源数据
4. **特殊值说明**：
   - "--" 表示该字段不适用或无需填写
   - "Err"/"ERR" 表示计算错误或数据异常
   - 空值表示数据未填写或不符合计算条件

---

**文档结束**
