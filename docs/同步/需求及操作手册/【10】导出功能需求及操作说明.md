# 导出功能需求及操作说明

## 一、需求文档

### 功能目标
我需要多种导出功能，能够将IO清单数据导出为不同格式的Excel文件，满足不同使用场景的需求。包括：快速导出到桌面、自定义字段导出、板卡清单导出、端接清单导出、数据库格式导出、机柜报警表导出等。

### 导出功能分类

系统提供以下导出功能：

1. **导出到桌面并打开**：快速导出当前IO清单到桌面，自动打开文件
2. **动态IO清单导出**：自定义选择字段、顺序、过滤条件的灵活导出
3. **导出主系统板卡清单**：导出所有板卡的详细配置信息
4. **导出板卡统计信息**：按板卡类型统计数量
5. **导出端接清单**：导出信号的端子接线信息
6. **导出FF从站箱端接清单**：导出FF从站设备的端接信息
7. **导出FF总线箱端接清单**：导出FF总线设备的端接信息
8. **导出龙鳍数据库**：按数据库表格式导出（AVI、PVI、AVO、DVI、DVO等9个表）
9. **导出机柜报警表**：导出机柜报警配置和RTU连接信息

---

## 1. 导出到桌面并打开

### 功能说明
最快捷的导出方式，一键导出当前IO清单到桌面并自动打开文件。

### 文件命名规则
```
{项目名}_{专业}_{子项}_IO清单.xlsx
```

**示例：**
- 项目名：核化工标准化
- 专业：仪控
- 子项：DCS系统
- 文件名：`核化工标准化_仪控_DCS系统_IO清单.xlsx`

### 数据来源
- 使用全量IO清单数据（AllData）
- 不受界面筛选、排序、分页影响

### 字段映射规则
- **有控制系统**：使用控制系统对应的字段映射（从config_controlSystem_mapping表）
- **无控制系统**：使用标准DisplayAttribute字段名

### 文件位置
- 固定导出到桌面
- 同一子项目的导出文件会覆盖旧文件（不带时间戳）

### 自动打开
导出完成后自动使用Excel打开文件

---

## 2. 动态IO清单导出

### 功能说明
提供完全自定义的导出配置，包括字段选择、顺序调整、过滤条件等。

### 配置选项

#### 字段选择
- 左侧列表：可选字段（按类别分组）
- 右侧列表：已选字段（实际导出的列）
- 支持拖拽调整顺序
- 支持多选批量添加/移除

#### 字段分组
- **基础信息**：信号位号、描述、IO类型等
- **分配信息**：机柜号、机笼号、插槽号、通道号等
- **电气参数**：供电类型、电气特性等
- **网络参数**：网段、站号、从站模块等
- **其他信息**：版本、修改日期、备注等

#### 数据过滤
- 按机柜筛选
- 按IO类型筛选
- 按信号类型筛选（普通/报警/备用）
- 自定义筛选条件

#### 配置保存
- 配置可保存到云端
- 下次导出时可直接加载
- 支持多套配置切换

### 导出选项
- 选择文件保存位置
- 设置工作表名称
- 选择是否包含表头

---

## 3. 导出主系统板卡清单

### 功能说明
导出所有机柜的板卡配置信息，包括控制器、电源、IO板卡等。

### 数据内容

#### 控制器板卡（自动添加）
每个机柜添加2块控制器：
- 插槽1-1：NP204控制器，板卡编号：{机柜号}101UC
- 插槽1-2：NP204控制器，板卡编号：{机柜号}102UC

#### 电源板卡（自动添加）
每个机笼添加2块电源板（插槽11和12）：
- 地址根据机笼号递增：B/C、2B/2C、3B/3C等

#### IO板卡
从机柜结构中提取已分配的所有IO板卡

#### 空插槽
补全未使用的插槽（每机笼12个插槽）

### 输出字段
| 字段名 | 说明 | 示例 |
|:------|:-----|:-----|
| 机柜编号 | 机柜名称 | 3ACKC001AR |
| 机架号 | 机笼号 | 1 |
| 插槽号 | 插槽位置 | 05 |
| 板卡地址 | 系统地址 | 4 |
| 板卡类型 | 卡型号 | AI201 |
| 板卡编号 | 完整编号 | 3ACKC001AR105AI |
| 端子板类型 | 端子板型号 | 201TN |
| 端子板编号 | 端子板完整编号 | 3ACKC001AR105TN |

### 排序规则
1. 机柜编号（升序）
2. 机笼号（升序）
3. 插槽号（升序）

---

## 4. 导出板卡统计信息

### 功能说明
按板卡类型统计数量，用于设备采购和资源规划。

### 统计维度
按{板卡类型, 端子板类型}分组统计

### 输出字段
| 字段名 | 说明 |
|:------|:-----|
| 序号 | 自动编号 |
| 板卡类型 | 如AI201、DI211 |
| 板卡数量 | 该类型板卡总数 |
| 端子板类型 | 如201TN、211TN |
| 端子板数量 | 该类型端子板总数 |

### 示例数据
```
序号  板卡类型  板卡数量  端子板类型  端子板数量
1     AI201    15       201TN      15
2     DI211    25       211TN      25
3     DO211    20       211TN      20
```

---

## 5. 导出端接清单

### 功能说明
导出所有信号的端子接线信息，用于现场施工接线。

### 数据来源
全量IO清单数据

### 输出字段
| 字段名 | 说明 |
|:------|:-----|
| 机柜号 | 信号所在机柜 |
| 端子板编号 | 端子板完整编号 |
| 端子号 | 通道号 |
| 信号位号 | 信号唯一标识 |
| 信号描述 | 信号说明 |
| 线缆编号 | 线缆标识 |
| 备注 | 其他信息 |

### 排序规则
1. 机柜号
2. 端子板编号
3. 端子号

---

## 6. 导出FF从站箱端接清单

### 功能说明
导出FF从站设备的端接信息，包含级联关系和供电端子。

### 筛选条件
- 仪表类型包含"从站"
- 就地箱号不为空

### 数据内容

#### 供电信号（自动添加）
每个就地箱自动添加供电端子：

**220VAC供电（端子01-06）**
- 端子板：101BN
- 端子：01-06
- 信号名称：220VAC供电

**24VDC供电（端子07-12）**
- 端子板：101BN
- 端子：07-12
- 信号名称：24VDC供电

#### FF信号
从数据中提取FF从站信号，按级联顺序排列

### 级联关系处理
调用SortByCascadeOrder()方法，按备注中的级联关系排序

---

## 7. 导出FF总线箱端接清单

### 功能说明
导出FF总线设备（FF1-FF6）的端接信息和级联拓扑。

### 筛选条件
供电类型包含FF1、FF2、FF3、FF4、FF5、FF6

### 数据处理

#### 级联关系分析
调用AnalyzeCascadeRelations()方法分析拓扑结构

#### 数据组织
按级联关系组织FF信号的端接信息

---

## 8. 导出龙鳍数据库

### 功能说明
按龙鳍系统数据库表格式导出，分为9个工作表。

### 工作表分类

| 工作表名 | IO类型 | 说明 |
|:---------|:-------|:-----|
| AVI | AI | 模拟量输入 |
| PVI | PI | 脉冲量输入 |
| AVO | AO | 模拟量输出 |
| DVI | DI | 数字量输入 |
| DVO | DO | 数字量输出 |
| GBP | - | 总线参数 |
| GCP | - | 计算参数 |
| GST | - | 状态参数 |
| GKC | - | 控制参数 |

### 可选导出
支持选择需要导出的工作表（复选框）

### 数据转换
每个工作表使用对应的数据模型类转换数据：
- AVI → xtes_AVI模型
- PVI → xtes_PVI模型
- AVO → xtes_AVO模型
- DVI → xtes_DVI模型
- DVO → xtes_DVO模型

### 1.1.1 AVI（模拟量输入）填充

过滤数据：供电类型前两个字符为“AI"。

| 序号 | 数据库列名             | 数据来源表                                                   | 值       |
| ---- | ---------------------- | ------------------------------------------------------------ | -------- |
| 1    | PN - 点名              | IO分站                                                       | 标签名称 |
| 2    | DESC - 点描述          | IO分站                                                       | 描述     |
| 3    | UNIT - 单位            | IO分站                                                       | 工程单位 |
| 4    | MU - 量程上限          | IO分站                                                       | 量程上限 |
| 5    | MD - 量程下限          | IO分站                                                       | 量程下限 |
| 6    | SN - 站号              | IO分站                                                       | 站号     |
| 7    | CLN - IO卡槽位地址号   | IO分站                                                       | 板卡地址 |
| 8    | MON - IO卡名           | IO分站                                                       | 板卡类型 |
| 9    | OF - 显示格式          | 量程范围（绝对值）： ≤10，3； ≤100，2； ≤1000000，1；＞1000000，4 |          |
| 10   | SD - 超量程恢复死区(%) | 1                                                            |          |
| 11   | OLT - 超量程判断选择   | 3                                                            |          |
| 12   | DI - 阈值恢复死区(%)   | 1                                                            |          |
| 13   | GROUPS - 变量分组      | 1                                                            |          |
| 14   | SYS - 系统名           | IO分站                                                       | 系统代码 |
| 15   | SUBNET - 子网          | IO分站                                                       | 子网     |
| 16   | TP - 信号类型          | AI212:6AI213:1AI214:6AI216:6AI221:13AI231:7AI232:7           |          |

### 1.1.1 PVI（脉冲量输入）

过滤数据：供电类型前两个字符为“PI"。

| 序号 | 数据库列名                   | 数据来源表                                            | 值       |
| ---- | ---------------------------- | ----------------------------------------------------- | -------- |
| 1    | PN - 点名                    | IO分站                                                | 标签名称 |
| 2    | DESC - 点描述                | IO分站                                                | 描述     |
| 3    | UNIT - 单位                  | IO分站                                                | 工程单位 |
| 4    | MU - 量程上限                | IO分站                                                | 量程上限 |
| 5    | MD - 量程下限                | IO分站                                                | 量程下限 |
| 6    | SN - 站号                    | IO分站                                                | 站号     |
| 7    | CLN - IO卡槽位地址号         | IO分站                                                | 板卡地址 |
| 8    | MON - IO卡名                 | IO分站                                                | 板卡类型 |
| 9    | OF - 显示格式                | 量程范围（绝对值）： ≤10，3； ≤100，2； ≤1000000，1； |          |
| 10   | SD - 超量程恢复死区(%)       | 1                                                     |          |
| 11   | OLQ - 超量程是否影响信号质量 | 1                                                     |          |
| 12   | OLT - 超量程判断选择         | 3                                                     |          |
| 13   | PG - 脉冲当量                | 0.001                                                 |          |
| 14   | GROUPS - 变量分组            | 1                                                     |          |
| 15   | SYS - 系统名                 | IO分站                                                | 系统代码 |
| 16   | SUBNET - 子网                | IO分站                                                | 子网     |

### 1.1.1 AVO（模拟量输出）

过滤数据：供电类型前两个字符为“AO"。

| 序号 | 数据库列名           | 数据来源表                                            | 值       |
| ---- | -------------------- | ----------------------------------------------------- | -------- |
| 1    | PN - 点名            | IO分站                                                | 标签名称 |
| 2    | DESC - 点描述        | IO分站                                                | 描述     |
| 3    | UNIT - 单位          | IO分站                                                | 工程单位 |
| 4    | MU - 量程上限        | IO分站                                                | 量程上限 |
| 5    | MD - 量程下限        | IO分站                                                | 量程下限 |
| 6    | SYS - 系统名         | IO分站                                                | 系统代码 |
| 7    | SUBNET - 子网        | IO分站                                                | 子网     |
| 8    | CLN - IO卡槽位地址号 | IO分站                                                | 板卡地址 |
| 9    | MON - IO卡名         | IO分站                                                | 板卡类型 |
| 10   | SN - 站号            | IO分站                                                | 站号     |
| 11   | OF - 显示格式        | 量程范围（绝对值）： ≤10，3； ≤100，2； ≤1000000，1； |          |
| 12   | GROUPS - 变量分组    | 1                                                     |          |

### 1.1.1 DVI（开关量输入）

过滤数据：供电类型前两个字符为“DI"。

| 序号 | 数据库列名              | 数据来源表 | 值       |
| ---- | ----------------------- | ---------- | -------- |
| 1    | PN - 点名               | IO分站     | 标签名称 |
| 2    | DESC - 点描述           | IO分站     | 描述     |
| 3    | INLOG - 是否进日志      | 0          |          |
| 4    | SYS - 系统名            | IO分站     | 系统代码 |
| 5    | SUBNET - 子网           | IO分站     | 子网     |
| 6    | CLN - IO卡槽位地址号    | IO分站     | 板卡地址 |
| 7    | MON - IO卡名            | IO分站     | 板卡类型 |
| 8    | SN - 站号               | IO分站     | 站号     |
| 9    | TOC - 发生抖动时间限(s) | 1          |          |
| 10   | BCT - 是否判断抖动      | 1          |          |
| 11   | DBT - 硬件消抖时间(ms)  | 100        |          |
| 12   | IC - 是否产生仪控故障   | 1          |          |
| 13   | GROUPS - 变量分组       | 1          |          |

### 1.1.1 DVO（开关量输出）

过滤数据：供电类型前两个字符为“DO"。

| 序号 | 数据库列名           | 数据来源表 | 值       |
| ---- | -------------------- | ---------- | -------- |
| 1    | PN - 点名            | IO分站     | 标签名称 |
| 2    | DESC - 点描述        | IO分站     | 描述     |
| 3    | INLOG - 是否进日志   | 0          |          |
| 14   | SYS - 系统名         | IO分站     | 系统代码 |
| 15   | SUBNET - 子网        | IO分站     | 子网     |
| 7    | CLN - IO卡槽位地址号 | IO分站     | 板卡地址 |
| 8    | MON - IO卡名         | IO分站     | 板卡类型 |
| 6    | SN - 站号            | IO分站     | 站号     |
| 13   | GROUPS - 变量分组    | 1          |          |

### 1.1.1 AM（Real型模拟量一层中间点）

过滤数据：供电类型为FF1~FF6

| 序号 | 数据库列名                   | 数据来源表                                                   | 值                          |
| ---- | ---------------------------- | ------------------------------------------------------------ | --------------------------- |
| 1    | PN - 点名                    | IO分站                                                       | 标签名称(供电类型为FF1~FF6) |
| 2    | DESC - 点描述                | IO分站                                                       | 描述(供电类型为FF1~FF6)     |
| 3    | UNIT - 单位                  | IO分站                                                       | 工程单位(供电类型为FF1~FF6) |
| 4    | MU - 量程上限                | IO分站                                                       | 量程上限(供电类型为FF1~FF6) |
| 5    | MD - 量程下限                | IO分站                                                       | 量程下限(供电类型为FF1~FF6) |
| 6    | SYS - 系统名                 | IO分站                                                       | 系统代码(供电类型为FF1~FF6) |
| 7    | SUBNET - 子网                | IO分站                                                       | 子网(供电类型为FF1~FF6)     |
| 8    | SN - 站号                    | IO分站                                                       | 站号(供电类型为FF1~FF6)     |
| 10   | MON - IO卡名                 | IO分站                                                       | 板卡类型(供电类型为FF1~FF6) |
| 11   | OF - 显示格式                | 量程范围（绝对值）： ≤10，3； ≤100，2； ≤1000000，1；＞1000000，4 |                             |
| 12   | QFIA - 输出替代值            | 1                                                            |                             |
| 13   | SD - 超量程恢复死区(%)       | 1.0                                                          |                             |
| 14   | OLQ - 超量程是否影响信号质量 | 1                                                            |                             |
| 15   | OLT - 超量程判断选择         | 3                                                            |                             |
| 16   | GROUPS - 变量分组            | 1                                                            |                             |

### 1.1.1 DM_FEW（开关量一层中间点）

过滤数据：供电类型为FF7~FF8、DP2

| 序号 | 数据库列名          | 数据来源表 | 值                               |
| ---- | ------------------- | ---------- | -------------------------------- |
| 1    | PN - 点名           | IO分站     | 标签名称(供电类型为FF7~FF8、DP2) |
| 2    | DESC - 点描述       | IO分站     | 描述(供电类型为FF7~FF8、DP2)     |
|      | IH - 是否进历史库   | 1          |                                  |
| 6    | SYS - 系统名        | IO分站     | 系统代码(供电类型为FF7~FF8、DP2) |
|      | INLOG - 是否进日志  | 0          |                                  |
| 7    | SUBNET - 子网       | IO分站     | 子网(供电类型为FF7~FF8、DP2)     |
| 8    | SN - 站号           | IO分站     | 站号(供电类型为FF7~FF8、DP2)     |
| 9    | E1 - 置1说明        | 1          |                                  |
| 10   | E0 - 置0说明        | 0          |                                  |
| 11   | HIGH - 是否高速上传 | 0          |                                  |
| 16   | GROUPS - 变量分组   | 1          |                                  |

### 1.1.1 GBP（开关类设备点）

根据IO分站供电类型前两位为DO的点且（扩展码含K/G/KG/Q/T/QT)，按照信号位号分组，每组形成一条数据。

| 序号 | 数据库列名        | 数据来源表 | 值                                                           |
| ---- | ----------------- | ---------- | ------------------------------------------------------------ |
| 1    | PN - 点名         | IO分站     | 根据IO分站DO点（扩展码含K/G/KG/Q/T/QT)，去掉重名及扩展码，建在GBP,如遇到重名的既有DO也有AO的，则建到GCP里 |
| 2    | DESC - 点描述     | IO分站     | DO点对应描述去掉“开、关、开关、启动、停止”字样，剩余部分保留 |
| 3    | SYS - 系统名      | IO分站     | 系统代码                                                     |
| 4    | SUBNET - 子网     | IO分站     | 子网                                                         |
| 5    | SN - 站号         | IO分站     | 站号                                                         |
| 6    | GROUPS - 变量分组 | 1          |                                                              |

### 1.1.1 GCP（调节类设备点）

根据IO分站供电类型前两位为DO的点且（扩展码含K/G/KG/Q/T/QT)，按照信号位号分组，每组形成一条数据。

| 序号 | 数据库列名        | 数据来源表 | 值                                                           |
| ---- | ----------------- | ---------- | ------------------------------------------------------------ |
| 1    | PN - 点名         | IO分站     | 去掉重名及扩展码，建在GBP,如遇到重名的既有DO也有AO的，则建到GCP里 |
| 2    | DESC - 点描述     | IO分站     | DO点对应描述去掉“开、关、开关、启动、停止”字样，剩余部分保留 |
| 3    | SYS - 系统名      | IO分站     | 系统代码                                                     |
| 5    | SUBNET - 子网     | IO分站     | 子网                                                         |
| 6    | SN - 站号         | IO分站     | 站号                                                         |
| 7    | GROUPS - 变量分组 | 1          |                                                              |

---

## 9. 导出机柜报警表

### 功能说明
导出机柜报警配置和RTU连接信息，用于报警系统配置。

### 数据来源
配置表：config_xt2_cabinet_alarm

### 配置表字段
| 字段名 | 说明 | 示例 |
|:------|:-----|:-----|
| CabinetName | 机柜名称 | 3ACKC001AR |
| RTUCabinetNumber | RTU板卡所在机柜号 | 3ACKC001AR |
| RTUBoardPosition | RTU板卡位置 | 1-0-04 |
| Room | 房间号 | E101 |
| SerialNumber | 序号（用于排序） | 1 |

### 输出字段计算

#### RTU板卡位置
- 格式：{机柜号}{柜内编号}{卡类型}
- 计算：从RTUBoardPosition解析机笼和插槽，调用GetCardNumber方法
- 示例：1-0-04 → 3ACKC001AR104MD

#### RTU板卡地址
- 公式：(机笼号-1) × 10 + 插槽号
- 示例：机笼1插槽4 → (1-1)×10+4 = 4

#### 端口号
- 解析RTUBoardPosition中间的数字
- 0 → COM0，1 → COM1
- 示例：1-**0**-04 → COM0

#### 从站设备
- 格式：{机柜名称}_ALM
- 示例：3ACKC001AR → 3ACKC001AR_ALM

#### 从站地址
- 解析RTUBoardPosition最后一位数字
- 示例：1-0-**04** → 4

#### 串接顺序
- 同一RTU分组内的所有机柜
- 按SerialNumber降序排列
- 用"串"连接，最后"接"RTU板卡位置+端口号
- 示例：3ACKC004AR串3ACKC003AR串3ACKC001AR接3ACKC001AR104MDCOM0

---

## 二、用户手册

### 快速导出（导出到桌面并打开）

**操作步骤：**
1. 在IO清单页面，点击"导出到桌面并打开"按钮
2. 系统自动导出到桌面，文件名为：{项目名}_{专业}_{子项}_IO清单.xlsx
3. 系统自动用Excel打开文件
4. 查看导出结果

**适用场景：**
- 快速查看完整IO清单
- 临时导出数据
- 不需要自定义配置

**注意事项：**
- 同一子项目的导出会覆盖旧文件
- 文件固定保存在桌面
- 导出全量数据，不受界面筛选影响

---

### 自定义导出（动态IO清单导出）

**操作步骤：**

**第一步：打开配置窗口**
1. 点击"动态IO清单导出"按钮
2. 弹出导出配置窗口

**第二步：选择字段**
1. 左侧：可选字段列表（按类别折叠展示）
2. 右侧：已选字段列表（实际导出的列）
3. 双击字段添加到右侧
4. 或拖拽字段到右侧
5. 支持批量选择（Ctrl+点击）

**第三步：调整顺序**
1. 在右侧列表拖拽字段调整顺序
2. 或使用上移/下移按钮

**第四步：设置过滤条件（可选）**
1. 选择机柜筛选
2. 选择IO类型筛选
3. 设置其他筛选条件

**第五步：保存配置（可选）**
1. 点击"保存配置"按钮
2. 输入配置名称
3. 配置保存到云端

**第六步：导出**
1. 点击"导出"按钮
2. 选择保存位置和文件名
3. 等待导出完成

**适用场景：**
- 需要特定字段组合
- 需要按顺序导出
- 需要多次使用相同配置
- 需要过滤特定数据

---

### 导出板卡清单

**操作步骤：**
1. 点击"导出主系统板卡清单"按钮
2. 选择保存位置和文件名
3. 等待导出完成
4. 打开文件查看

**文件内容：**
- 所有机柜的所有板卡
- 控制器板卡（自动添加）
- 电源板卡（自动添加）
- IO板卡（从机柜结构提取）
- 空插槽（自动补全）

**适用场景：**
- 硬件配置清单
- 设备采购清单
- 机柜配置文档

---

### 导出统计信息

**操作步骤：**
1. 点击"导出板卡统计信息"按钮
2. 选择保存位置和文件名
3. 等待导出完成
4. 打开文件查看统计结果

**适用场景：**
- 设备采购计划
- 资源统计报表
- 成本预算

---

### 导出端接清单

**操作步骤：**
1. 点击"导出端接清单"按钮
2. 选择保存位置和文件名
3. 等待导出完成
4. 打开文件查看

**适用场景：**
- 现场施工接线
- 端子排布局
- 接线检查

---

### 导出FF清单

**FF从站箱端接清单：**
1. 点击"导出FF从站箱端接清单"按钮
2. 选择保存位置和文件名
3. 导出包含供电端子和FF信号的清单

**FF总线箱端接清单：**
1. 点击"导出FF总线箱端接清单"按钮
2. 选择保存位置和文件名
3. 导出包含级联关系的FF总线清单

**适用场景：**
- FF总线设备接线
- FF网络拓扑文档
- FF设备调试

---

### 导出数据库格式

**操作步骤：**

**第一步：打开配置窗口**
1. 点击"导出龙鳍数据库"按钮
2. 弹出数据库导出配置窗口

**第二步：选择工作表**
1. 勾选需要导出的工作表
2. 可全选或单独选择
3. 至少选择一个工作表

**第三步：导出**
1. 点击"导出"按钮
2. 选择保存位置和文件名
3. 等待导出完成

**适用场景：**
- 系统数据库导入
- 按表格式分类数据
- 符合系统标准格式

---

### 导出机柜报警表

**前置条件：**
- 必须先在配置表（config_xt2_cabinet_alarm）中配置机柜报警信息

**操作步骤：**
1. 点击"导出机柜报警表"按钮
2. 选择保存位置和文件名
3. 等待导出完成
4. 打开文件查看RTU配置信息

**适用场景：**
- RTU报警系统配置
- 机柜报警模块接线
- 报警网络拓扑

---

### 通用注意事项

1. **数据完整性**：所有导出基于全量数据（AllData），不受界面筛选、排序影响

2. **状态提示**：导出过程在状态栏显示进度，不会弹出对话框

3. **文件覆盖**："导出到桌面"会覆盖同名文件，其他导出会提示是否覆盖

4. **大数据量**：数据量大时导出可能较慢，耐心等待

5. **Excel兼容性**：导出的xlsx格式与Excel 2007及以上版本兼容

6. **中文字段**：如果有控制系统，字段名会使用中文映射

7. **空数据提示**：如果没有数据，会提示"没有可导出的数据"

8. **异常处理**：导出失败会在状态栏显示错误信息

---

### 常见问题

**问题1：提示"没有可导出的数据"**
- 原因：IO清单为空
- 解决：先导入或添加IO数据

**问题2：导出的字段名是英文**
- 原因：未配置控制系统或控制系统字段映射缺失
- 解决：检查子项目的控制系统设置，或补充字段映射配置

**问题3：导出到桌面找不到文件**
- 原因：文件可能被其他程序占用或删除
- 解决：检查桌面，或重新导出

**问题4：动态导出配置保存失败**
- 原因：网络问题或权限不足
- 解决：检查网络连接，或联系管理员

**问题5：板卡清单中缺少某些板卡**
- 原因：IO分配未执行或分配失败
- 解决：先执行IO分配，确保所有信号已分配

**问题6：端接清单中端子号不连续**
- 原因：某些通道未分配信号（正常现象）
- 解决：这是正常的，空通道不会出现在端接清单中

**问题7：FF清单为空**
- 原因：没有FF类型的信号
- 解决：确认IO清单中有FF信号，检查筛选条件

**问题8：数据库导出某些工作表为空**
- 原因：没有对应IO类型的信号
- 解决：这是正常的，可以只导出有数据的工作表

**问题9：机柜报警表导出失败**
- 原因：配置表（config_xt2_cabinet_alarm）中无数据
- 解决：先在配置表中添加机柜报警配置

**问题10：导出文件打开后乱码**
- 原因：编码问题或Excel版本过低
- 解决：使用Excel 2007及以上版本打开；或尝试用WPS打开

**问题11：导出很慢**
- 原因：数据量大或计算复杂
- 解决：耐心等待；或分批导出；或只导出需要的字段

**问题12：想导出筛选后的数据**
- 原因：导出是全量数据，不受界面筛选影响
- 解决：使用"动态IO清单导出"的过滤功能
