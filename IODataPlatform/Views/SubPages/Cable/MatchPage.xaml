<Page 
    x:Class="IODataPlatform.Views.SubPages.Cable.MatchPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:local="clr-namespace:IODataPlatform.Views.SubPages.Cable"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    ui:NavigationView.HeaderContent="匹配端接数据"
    d:DataContext="{d:DesignInstance local:MatchPage, IsDesignTimeCreatable=False}"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    ScrollViewer.CanContentScroll="False"
    mc:Ignorable="d">

    <Grid>
        
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="auto"/>
        </Grid.ColumnDefinitions>

        <StackPanel Orientation="Horizontal" Grid.ColumnSpan="100">
            <TextBlock Text="{Binding ViewModel.Header1}" VerticalAlignment="Center"/>
            <ComboBox Margin="10,0,0,0" ItemsSource="{Binding ViewModel.Publishes1}" SelectedItem="{Binding ViewModel.Publish1}" Width="100">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding PublishedVersion}"/>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <TextBlock Margin="10,0,0,0" Text="{Binding ViewModel.Header2}" VerticalAlignment="Center"/>
            <ComboBox Margin="10,0,0,0" ItemsSource="{Binding ViewModel.Publishes2}" SelectedItem="{Binding ViewModel.Publish2}" Width="100">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding PublishedVersion}"/>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <Menu Grid.ColumnSpan="100">
                <ui:MenuItem Header="开始匹配" Icon="{ui:SymbolIcon Play24}"  Command="{Binding ViewModel.MatchCommand}"/>
                <Separator />
                <ui:MenuItem Header="保存临时数据"
                             Icon="{ui:SymbolIcon DocumentSave24}" 
                             Command="{Binding ViewModel.SaveCommand}"/>
                <ui:MenuItem Header="加载临时数据"
                             Icon="{ui:SymbolIcon ClockArrowDownload24}"
                             Command="{Binding ViewModel.LoadCommand}"/>
                <ui:MenuItem Header="提交"
                             Icon="{ui:SymbolIcon TargetEdit24}">
                    <ui:MenuItem Header="覆盖全部数据" Command="{Binding ViewModel.OverwriteCommand}"/>
                    <ui:MenuItem Header="累加全部数据" Command="{Binding ViewModel.AppendCommand}"/>
                </ui:MenuItem>
            </Menu>
        </StackPanel>

        <Menu Grid.Row="1" Grid.ColumnSpan="100">
            <ui:MenuItem IsEnabled="False" Foreground="{DynamicResource TextFillColorPrimaryBrush}">
                <ui:MenuItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <ui:TextBlock Text="匹配成功电缆数：" FontSize="14"/>
                        <ui:TextBlock Margin="5,0,0,0" Text="{Binding ViewModel.SuccessDataCount}" FontSize="14"/>
                    </StackPanel>
                </ui:MenuItem.Header>
            </ui:MenuItem>
            <ui:MenuItem Header="匹配选择的数据" 
                         Icon="{ui:SymbolIcon MatchAppLayout24}"
                         Command="{Binding ViewModel.MatchSelectedCommand}"/>
        </Menu>

        <ui:DataGrid Grid.Row="2" Grid.Column="0" Style="{StaticResource DataGridStyle}" ItemsSource="{Binding ViewModel.Failist1}">
            <ui:DataGrid.Columns>
                <DataGridTemplateColumn Width="30">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <RadioButton GroupName="Fail1" Margin="5,0,0,0" IsChecked="{Binding IsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTextColumn Header="信号位号"
                                    Binding="{Binding Data.IOPointName}" />
                <DataGridTextColumn Header="盘箱柜号"
                                    Binding="{Binding Data.CabinetNumber}" />
        
                <DataGridTextColumn Header="原因" Binding="{Binding Reason}"/>
            </ui:DataGrid.Columns>
        </ui:DataGrid>
        
        <ui:DataGrid Grid.Row="2" Grid.Column="1" Style="{StaticResource DataGridStyle}" ItemsSource="{Binding ViewModel.Failist2}">
            <ui:DataGrid.Columns>
                <DataGridTemplateColumn Width="30">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <RadioButton GroupName="Fail2" Margin="5,0,0,0" IsChecked="{Binding IsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
               
                <DataGridTextColumn Header="信号位号"
                                    Binding="{Binding Data.IOPointName}" />
                <DataGridTextColumn Header="盘箱柜号"
                                    Binding="{Binding Data.CabinetNumber}" />
          
                <DataGridTextColumn Header="原因" Binding="{Binding Reason}"/>
            </ui:DataGrid.Columns>
        </ui:DataGrid>     
        
        <ui:DataGrid Grid.Row="2" Grid.Column="2" Style="{StaticResource DataGridStyle}" ItemsSource="{Binding ViewModel.SuccessList}">
            <ui:DataGrid.Columns>
                <DataGridTemplateColumn Width="73" Header="操作">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <ui:Button Content="拆分"
                                           Appearance="Caution"
                                           Icon="{ui:SymbolIcon ArrowSplit24}"
                                           CommandParameter="{Binding}"
                                           Command="{Binding RelativeSource={RelativeSource AncestorType=local:MatchPage}, Path=ViewModel.UnMatchCommand}"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTextColumn Header="起点信号位号"
                                    Binding="{Binding 起点信号位号}" />
                <DataGridTextColumn Header="起点房间号"
                                    Binding="{Binding 起点房间号}" />
                <DataGridTextColumn Header="起点盘柜名称"
                                    Binding="{Binding 起点盘柜名称}" />
                <DataGridTextColumn Header="终点信号位号"
                                    Binding="{Binding 终点信号位号}" />
                <DataGridTextColumn Header="终点盘柜名称"
                                    Binding="{Binding 终点盘柜名称}" />
            </ui:DataGrid.Columns>
        </ui:DataGrid>

    </Grid>
    
</Page>