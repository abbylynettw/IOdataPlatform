<Page 
    x:Class="IODataPlatform.Views.Pages.WordFormatBrushPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:local="clr-namespace:IODataPlatform.Views.Pages"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    mc:Ignorable="d"
    ScrollViewer.VerticalScrollBarVisibility="Disabled"
    ScrollViewer.HorizontalScrollBarVisibility="Disabled">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="162" />
        </Grid.RowDefinitions>

        <!-- 操作栏 -->
        <ui:Card Grid.Row="0" Margin="0,0,0,5" Padding="5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="40" />
                    <RowDefinition Height="40" />
                    <RowDefinition Height="400" />
                </Grid.RowDefinitions>

                <!-- 模板文件选择 -->
                <Grid Grid.Row="0" Margin="0,0,0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="80" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="模板文件：" VerticalAlignment="Center" FontWeight="Bold" />
                    <ui:TextBox Grid.Column="1" 
                                Text="{Binding ViewModel.TemplateFileName}" 
                                IsReadOnly="True" 
                                PlaceholderText="选择作为格式源的Word文件"
                                ToolTip="{Binding ViewModel.TemplateFilePath}"
                                Margin="0,0,5,0" />
                    <ui:Button Grid.Column="2" 
                               Content="浏览..." 
                               Command="{Binding ViewModel.SelectTemplateCommand}" 
                               Width="80" />
                </Grid>

                <!-- 目标文件选择 -->
                <Grid Grid.Row="1" Margin="0,0,0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="80" />
                        <ColumnDefinition Width="100" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="目标文件：" VerticalAlignment="Center" FontWeight="Bold" />
                    <ui:TextBox Grid.Column="1" 
                                Text="{Binding ViewModel.TargetFileName}" 
                                IsReadOnly="True" 
                                PlaceholderText="选择需要应用格式的Word文件"
                                ToolTip="{Binding ViewModel.TargetFilePath}"
                                Margin="0,0,5,0" />
                    <ui:Button Grid.Column="2" 
                               Content="浏览..." 
                               Command="{Binding ViewModel.SelectTargetCommand}" 
                               Width="80"
                               Margin="0,0,5,0" />
                    <ui:Button Grid.Column="3" 
                               Content="套用模板"
                               Icon="ArrowSync24"
                               Command="{Binding ViewModel.ApplyTemplateMergeCommand}"
                               Appearance="Primary"
                               Width="100"
                               ToolTip="将目标内容导入模板，自动套用模板的所有格式" />
                </Grid>

                <!-- 格式选项 -->
                <StackPanel Grid.Row="2" Orientation="Vertical">
                    <Expander Header="格式应用选项" IsExpanded="True" Margin="0,0,0,0">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" >
                            <StackPanel Margin="10">
                                <!-- 基础格式 -->
                                <TextBlock Text="基础格式" FontWeight="Bold" FontSize="11" Margin="0,0,0,3" />
                                <CheckBox Content="应用模板样式（标题1-5级、正文）" IsChecked="{Binding ViewModel.ApplyBaseStyles}" FontSize="11" Margin="0,0,0,8" />
                                
                                <!-- 图片题注 -->
                                <TextBlock Text="图片题注" FontWeight="Bold" FontSize="11" Margin="0,0,0,3" />
                                <WrapPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <CheckBox Content="题注格式" IsChecked="{Binding ViewModel.ApplyImageCaption}" FontSize="11" Margin="0,0,10,0" />
                                    <CheckBox Content="按章排列" IsChecked="{Binding ViewModel.ImageCaptionsByChapter}" FontSize="11" Margin="0,0,10,0" />
                                    <CheckBox Content="前后空行" IsChecked="{Binding ViewModel.ImageCaptionSpacing}" FontSize="11" Margin="0,0,0,0" />
                                </WrapPanel>
                                
                                <!-- 表格题注 -->
                                <TextBlock Text="表格题注" FontWeight="Bold" FontSize="11" Margin="0,0,0,3" />
                                <WrapPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <CheckBox Content="题注格式" IsChecked="{Binding ViewModel.ApplyTableCaption}" FontSize="11" Margin="0,0,10,0" />
                                    <CheckBox Content="按章排列" IsChecked="{Binding ViewModel.TableCaptionsByChapter}" FontSize="11" Margin="0,0,10,0" />
                                    <CheckBox Content="前后空行" IsChecked="{Binding ViewModel.TableCaptionSpacing}" FontSize="11" Margin="0,0,0,0" />
                                </WrapPanel>
                                
                                <!-- 页面设置 -->
                                <TextBlock Text="页面设置" FontWeight="Bold" FontSize="11" Margin="0,0,0,3" />
                                <CheckBox Content="页边距、纸张大小" IsChecked="{Binding ViewModel.ApplyPageSetup}" FontSize="11" Margin="0,0,0,0" />
                            </StackPanel>
                        </ScrollViewer>
                    </Expander>
                </StackPanel>
            </Grid>
        </ui:Card>

        <!-- 日志区域 -->
        <ui:Card Grid.Row="1" Padding="5" Margin="0,0,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="22" />
                    <RowDefinition Height="140" />
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0" Text="操作日志" FontWeight="Bold" Margin="0,0,0,5" />
                <ScrollViewer Grid.Row="1">
                    <TextBox Text="{Binding ViewModel.LogText}" 
                             IsReadOnly="True" 
                             TextWrapping="Wrap" 
                             BorderThickness="0"
                             Background="Transparent"
                             FontSize="12"
                             FontFamily="Consolas" />
                </ScrollViewer>
            </Grid>
        </ui:Card>
    </Grid>
</Page>
