<Window x:Class="IODataPlatform.Views.Windows.PointAddWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        mc:Ignorable="d"
        Title="æ·»åŠ æŠ¥è­¦ç‚¹"
        Height="750"
        Width="1100"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource ApplicationBackgroundBrush}">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- æ ‡é¢˜è¯´æ˜Žå’Œç±»åž‹é€‰æ‹© -->
        <StackPanel Grid.Row="0" Margin="0,0,0,15">
            <TextBlock x:Name="TitleText"
                       Text="æ·»åŠ æŠ¥è­¦ç‚¹" 
                       FontSize="18" 
                       FontWeight="SemiBold"
                       Margin="0,0,0,10"/>
            <TextBlock x:Name="DescriptionText"
                       Text="åŠŸèƒ½è¯´æ˜Žï¼šä»Žé…ç½®è¡¨è¯»å–æœºæŸœæŠ¥è­¦ä¿¡æ¯ï¼Œè‡ªåŠ¨ç”ŸæˆæŠ¥è­¦ç‚¹å¹¶åˆ†é…åˆ°å¯¹åº”æ¿å¡"
                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                       TextWrapping="Wrap"
                       Margin="0,0,0,15"/>
            
            <!-- ç±»åž‹é€‰æ‹© -->
            <Border BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}" 
                    BorderThickness="1" 
                    CornerRadius="4"
                    Background="{DynamicResource LayerFillColorDefaultBrush}"
                    Padding="15,10">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="æŠ¥è­¦ç±»åž‹ï¼š" 
                               VerticalAlignment="Center" 
                               Margin="0,0,15,0"
                               FontWeight="SemiBold"/>
                    <RadioButton x:Name="CommunicationAlarmTypeRadio"
                                 Content="ðŸ“¡ é€šè®¯æŠ¥è­¦ç‚¹" 
                                 IsChecked="True"
                                 Margin="0,0,20,0"
                                 VerticalAlignment="Center"/>
                    <RadioButton x:Name="HardwareAlarmTypeRadio"
                                 Content="ðŸ”Œ ç¡¬ç‚¹æŠ¥è­¦ç‚¹" 
                                 VerticalAlignment="Center"/>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- TabæŽ§ä»¶ -->
        <TabControl Grid.Row="2" 
                    x:Name="DataTabControl"
                    Margin="0,0,0,15">
            <!-- é…ç½®è¡¨æ•°æ®Tab -->
            <TabItem x:Name="ExcelDataTab" Header="é…ç½®è¡¨æ•°æ®">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Margin="10" Orientation="Horizontal">
                        <ui:SymbolIcon Symbol="Document24" FontSize="20" Margin="0,0,10,0" VerticalAlignment="Center"/>
                        <ui:TextBlock x:Name="ExcelDataCountText"
                                      Text="æœºæŸœæ•°æ®ï¼š0æ¡" 
                                      FontWeight="SemiBold"
                                      VerticalAlignment="Center"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" 
                              x:Name="ExcelDataGrid"
                              AutoGenerateColumns="True"
                              IsReadOnly="True"
                              GridLinesVisibility="All"
                              CanUserReorderColumns="True"
                              CanUserResizeColumns="True"
                              CanUserSortColumns="True"
                              SelectionMode="Single"
                              AlternatingRowBackground="{DynamicResource SubtleFillColorSecondaryBrush}"/>
                </Grid>
            </TabItem>

            <!-- æ ¡éªŒç»“æžœTabï¼ˆå·²åºŸå¼ƒï¼Œä¿ç•™ä»¥é¿å…ä»£ç é”™è¯¯ï¼‰ -->
            <TabItem x:Name="ValidationTab" Header="æ ¡éªŒç»“æžœ" Visibility="Collapsed">
                <Border Margin="10" 
                        BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}" 
                        BorderThickness="1" 
                        CornerRadius="4"
                        Background="{DynamicResource LayerFillColorDefaultBrush}">
                    <DockPanel Margin="10">
                        <!-- æ ‡é¢˜ -->
                        <TextBlock DockPanel.Dock="Top" Text="æ•°æ®æ ¡éªŒ" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,5"/>
                        
                        <!-- æ ¡éªŒç»“æžœæ—¥å¿—åŒº -->
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <TextBlock x:Name="ValidationResultText"
                                       Text="è¯·å…ˆé€‰æ‹©Excelæ–‡ä»¶å¹¶ç‚¹å‡»'ä¸‹ä¸€æ­¥'è¿›è¡Œæ•°æ®æ ¡éªŒ"
                                       FontFamily="Cascadia Code, Consolas, Courier New"
                                       FontSize="11"
                                       TextWrapping="Wrap"
                                       LineHeight="18"/>
                        </ScrollViewer>
                    </DockPanel>
                </Border>
            </TabItem>

            <!-- ç”Ÿæˆé¢„è§ˆTab -->
            <TabItem x:Name="PreviewTab" Header="ç”Ÿæˆé¢„è§ˆ">
                <Border Margin="10" 
                        BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}" 
                        BorderThickness="1" 
                        CornerRadius="4"
                        Background="{DynamicResource LayerFillColorDefaultBrush}">
                    <DockPanel Margin="10">
                        <!-- æ ‡é¢˜å’Œç»Ÿè®¡ä¿¡æ¯ -->
                        <StackPanel DockPanel.Dock="Top" Margin="0,0,0,10">
                            <TextBlock Text="é¢„è§ˆç»“æžœ" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="å·²ç”Ÿæˆï¼š" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="GeneratedCountText" Text="0" FontSize="11" FontWeight="Bold" Foreground="#4CAF50"/>
                                <TextBlock Text=" æ¡" FontSize="11" Foreground="Gray"/>
                                
                                <TextBlock Text=" | å·²åˆ†é…ï¼š" FontSize="11" Foreground="Gray" Margin="10,0,0,0"/>
                                <TextBlock x:Name="AllocatedCountText" Text="0" FontSize="11" FontWeight="Bold" Foreground="#1976D2"/>
                                <TextBlock Text=" æ¡" FontSize="11" Foreground="Gray"/>
                                
                                <TextBlock Text=" | æœªåˆ†é…ï¼š" FontSize="11" Foreground="Gray" Margin="10,0,0,0"/>
                                <TextBlock x:Name="UnallocatedCountText" Text="0" FontSize="11" FontWeight="Bold" Foreground="OrangeRed"/>
                                <TextBlock Text=" æ¡" FontSize="11" Foreground="Gray"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- é¢„è§ˆè¡¨æ ¼ -->
                        <DataGrid x:Name="PreviewGrid"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  GridLinesVisibility="All"
                                  CanUserReorderColumns="True"
                                  CanUserResizeColumns="True"
                                  CanUserSortColumns="True"
                                  SelectionMode="Single"
                                  AlternatingRowBackground="{DynamicResource SubtleFillColorSecondaryBrush}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ç‚¹ç±»åž‹" Binding="{Binding PointType}" Width="120"/>
                                <DataGridTextColumn Header="IOç±»åž‹" Binding="{Binding IoType}" Width="80"/>
                                <DataGridTextColumn Header="æ‰©å±•ç " Binding="{Binding ExtensionCode}" Width="80"/>
                                <DataGridTextColumn Header="ä¿¡å·ä½å·" Binding="{Binding SignalPositionNumber}" Width="100"/>
                                <DataGridTextColumn Header="æ ‡ç­¾åç§°" Binding="{Binding TagName}" Width="120"/>
                                <DataGridTextColumn Header="ä¿¡å·åŠŸèƒ½" Binding="{Binding Description}" Width="*" MinWidth="150"/>
                                <DataGridTextColumn Header="ç³»ç»Ÿä»£ç " Binding="{Binding SystemCode}" Width="100"/>
                                <DataGridTextColumn Header="æœºæŸœå·" Binding="{Binding CabinetNumber}" Width="100"/>
                                <DataGridTextColumn Header="ç½‘æ®µ" Binding="{Binding NetType}" Width="80"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </DockPanel>
                </Border>
            </TabItem>
        </TabControl>

        <!-- çŠ¶æ€æ  -->
        <Border Grid.Row="3" 
                Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                BorderThickness="1"
                BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                CornerRadius="4"
                Padding="10"
                Margin="0,0,0,15">
            <ui:TextBlock x:Name="StatusText" 
                          Text="è¯·é€‰æ‹©è¦æ·»åŠ çš„æŠ¥è­¦ç‚¹ç±»åž‹"
                          Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
        </Border>

        <!-- åº•éƒ¨æŒ‰é’® -->
        <StackPanel Grid.Row="4" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right">
            <ui:Button x:Name="PreviousButton"
                       Content="ä¸Šä¸€æ­¥"
                       Icon="{ui:SymbolIcon ArrowLeft24}"
                       Appearance="Secondary"
                       Margin="0,0,10,0"
                       MinWidth="100"
                       Visibility="Collapsed"
                       Click="PreviousButton_Click"/>
            <ui:Button x:Name="NextButton"
                       Content="ä¸‹ä¸€æ­¥"
                       Icon="{ui:SymbolIcon ArrowRight24}"
                       Appearance="Primary"
                       Margin="0,0,10,0"
                       MinWidth="100"
                       IsEnabled="False"
                       Click="NextButton_Click"/>
            <ui:Button x:Name="ConfirmButton"
                       Content="ç¡®è®¤æ·»åŠ "
                       Icon="{ui:SymbolIcon Checkmark24}"
                       Appearance="Primary"
                       Margin="0,0,10,0"
                       MinWidth="100"
                       IsEnabled="False"
                       Visibility="Collapsed"
                       Click="ConfirmButton_Click"/>
            <ui:Button x:Name="CancelButton"
                       Content="å–æ¶ˆ"
                       Icon="{ui:SymbolIcon Dismiss24}"
                       Appearance="Secondary"
                       MinWidth="100"
                       Click="CancelButton_Click"/>
        </StackPanel>
    </Grid>
</Window>
