<Window x:Class="IODataPlatform.Views.Windows.ColumnValidationResultWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        mc:Ignorable="d"
        Title="列结构验证结果" 
        Height="600" 
        Width="900"
        MinHeight="400"
        MinWidth="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        WindowStyle="SingleBorderWindow">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,20">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <ui:SymbolIcon Symbol="CheckboxChecked24" FontSize="24" VerticalAlignment="Center"/>
                <ui:TextBlock Text="列结构验证结果" FontSize="20" FontWeight="Bold" Margin="12,0,0,0" VerticalAlignment="Center"/>
            </StackPanel>
            <ui:TextBlock x:Name="SummaryText" 
                          Text="正在检查..." 
                          FontSize="14" 
                          Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
        </StackPanel>

        <!-- 验证结果列表 -->
        <Border Grid.Row="1" 
                BorderBrush="{DynamicResource ControlElevationBorderBrush}" 
                BorderThickness="1" 
                CornerRadius="6" 
                Margin="0,0,0,20">
            <ScrollViewer>
                <ItemsControl x:Name="ValidationResultsItemsControl" Margin="15">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Margin="0,0,0,15" 
                                    Padding="15"
                                    BorderBrush="{DynamicResource ControlElevationBorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6"
                                    Background="{DynamicResource LayerFillColorDefaultBrush}">
                                <StackPanel>
                                    <!-- 表名和状态 -->
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon x:Name="StatusIcon" 
                                                       Symbol="{Binding StatusIcon}" 
                                                       FontSize="20" 
                                                       Foreground="{Binding StatusColor}"
                                                       VerticalAlignment="Center"/>
                                        <ui:TextBlock Text="{Binding SheetName}" 
                                                      FontSize="16" 
                                                      FontWeight="Bold" 
                                                      Margin="10,0,0,0"
                                                      VerticalAlignment="Center"/>
                                        <ui:TextBlock Text="{Binding StatusText}" 
                                                      FontSize="14" 
                                                      Foreground="{Binding StatusColor}"
                                                      Margin="10,0,0,0"
                                                      VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <!-- 缺少的列 -->
                                    <StackPanel Visibility="{Binding HasMissingColumns}">
                                        <ui:TextBlock Text="Excel缺少的列（模型定义有，但Excel没有）：" 
                                                      FontSize="13" 
                                                      FontWeight="Medium"
                                                      Foreground="#D32F2F"
                                                      Margin="0,5,0,5"/>
                                        <TextBlock Text="{Binding MissingColumns}" 
                                                   TextWrapping="Wrap"
                                                   FontSize="12"
                                                   Foreground="#D32F2F"
                                                   Margin="15,0,0,0"/>
                                    </StackPanel>

                                    <!-- 多余的列 -->
                                    <StackPanel Visibility="{Binding HasExtraColumns}">
                                        <ui:TextBlock Text="Excel多余的列（Excel有，但模型定义没有）：" 
                                                      FontSize="13" 
                                                      FontWeight="Medium"
                                                      Foreground="#F57C00"
                                                      Margin="0,5,0,5"/>
                                        <TextBlock Text="{Binding ExtraColumns}" 
                                                   TextWrapping="Wrap"
                                                   FontSize="12"
                                                   Foreground="#F57C00"
                                                   Margin="15,0,0,0"/>
                                    </StackPanel>

                                    <!-- 列数统计 -->
                                    <ui:TextBlock Text="{Binding ColumnCountInfo}" 
                                                  FontSize="12" 
                                                  Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                  Margin="0,5,0,0"/>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>

        <!-- 操作按钮 -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right">
            <ui:Button x:Name="CloseButton" 
                       Content="关闭" 
                       Click="CloseButton_Click" 
                       MinWidth="100"/>
        </StackPanel>
    </Grid>
</Window>
