<ui:FluentWindow x:Class="IODataPlatform.Views.Windows.ExcelFilterWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        Title="筛选" Height="500" Width="350"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 搜索框 -->
        <ui:TextBox Grid.Row="0" 
                    Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                    PlaceholderText="搜索..."
                    Margin="0,0,0,10"/>

        <!-- 操作按钮 -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
            <ui:Button Content="全选" Click="SelectAll_Click" Margin="0,0,5,0"/>
            <ui:Button Content="全不选" Click="UnselectAll_Click" Margin="0,0,5,0"/>
            <ui:Button Content="反选" Click="InverseSelect_Click"/>
        </StackPanel>

        <!-- 选项列表 -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding FilteredOptions}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <CheckBox IsChecked="{Binding IsSelected}" Margin="5">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding Value}" VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding Count, StringFormat=' ({0})'}" 
                                          Foreground="Gray" 
                                          FontSize="11"
                                          VerticalAlignment="Center"
                                          Margin="5,0,0,0"/>
                            </StackPanel>
                        </CheckBox>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- 确认/取消按钮 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <ui:Button Content="确定" 
                      Click="ConfirmButton_Click" 
                      Appearance="Primary"
                      Margin="0,0,10,0"/>
            <ui:Button Content="取消" 
                      Click="CancelButton_Click"/>
        </StackPanel>
    </Grid>
</ui:FluentWindow>
